
<html>
    <head>
        <title>Electricity Meter Service</title>
        <script>
            function registerMeter() {
                var meterId = document.getElementById("meterId").value.trim();

                if (!meterId) {
                    document.getElementById("result").innerText = "Please enter a Meter ID.";
                    return;
                }

                fetch('/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ meter_id: meterId })
                })
                .then(response => response.json().then(data => ({ status: response.status, body: data }))) 
                .then(response => {
                    document.getElementById("result").innerText = response.body.message;
                    document.getElementById("meterId").value = response.body.meter_id;
                })
                .catch(error => {
                    document.getElementById("result").innerText = "Error registering meter. Please try again.";
                });
            }

            function generateReadings() {
                var meterId = document.getElementById("meterId").value;
                if (!meterId) {
                    document.getElementById("result").innerText = "Please enter a valid Meter ID.";
                    return;
                }
                fetch('/generate_readings/' + meterId)
                .then(response => response.json())
                .then(data => {
                    document.getElementById("result").innerText = "Readings generated for Meter: " + meterId;
                })
                .catch(error => {
                    document.getElementById("result").innerText = "Error generating readings.";
                });
            }

            function viewDailyUsage() {
                var meterId = document.getElementById("meterId").value;
                if (!meterId) {
                    document.getElementById("result").innerText = "Please enter a valid Meter ID.";
                    return;
                }
                window.location.href = "/meter/daily/" + meterId;
            }

            function viewMonthlyUsage() {
                var meterId = document.getElementById("meterId").value;
                if (!meterId) {
                    document.getElementById("result").innerText = "Please enter a valid Meter ID.";
                    return;
                }
                window.location.href = "/meter/monthly/" + meterId;
            }
        </script>
    </head>
    <body>
        <h1>Electricity Meter Service</h1>
        <label for="meterId">Enter Meter ID (format: XXX-XXX-XXX):</label>
        <input type="text" id="meterId" name="meterId" placeholder="e.g., 123-456-789">
        
        <button onclick="registerMeter()">Register Meter</button>
        <button onclick="generateReadings()">Generate Readings</button>
        <button onclick="viewDailyUsage()">View Daily Usage</button>
        <button onclick="viewMonthlyUsage()">View Monthly Usage</button>

        <p id="result"></p>
    </body>
</html>